# Day 6 Malware Analysis - Egg-xecutable

## Scenario Overview
- SOC team at The Best Festival Company (TBFC) receives a suspicious 3AM email from "Elf McClause".
- Attachment: **HopHelper.exe**, claimed to be a rotaâ€‘management tool.
- Elf McBlue decides to investigate the executable for potential malware.

---

## Learning Objectives
- Principles of malware analysis
- Use of sandboxes
- Static vs. dynamic analysis
- Tools: PeStudio, ProcMon, Regshot

---

## Principles of Malware Analysis
### Purpose
- Understand malware behavior and capabilities.
- Identify defensive measures.
- Detect indicators of compromise (IoCs).

### Two Main Types of Analysis
1. **Static Analysis**
   - Examine file without executing it.
   - Quick, useful for high-level info.
   - Techniques:
     - Checksums (e.g., SHA256)
     - Strings
     - Imports
     - Resources

2. **Dynamic Analysis**
   - Execute malware in a safe, isolated environment.
   - Observe real behavior.

---

## Sandboxes
- Safe, disposable environments for running malicious code.
- Often virtual machines with snapshot capability.
- Golden rule: **Never run malware on a machine you care about.**

---

## Static Analysis (Tools & Process)

### Using PeStudio
1. Launch PeStudio.
2. Load sample (HopHelper.exe).
3. Review:
   - **SHA256 checksum**
   - **Strings** (e.g., IPs, URLs, commands)
   - **Imports** (e.g., CreateFileW)
   - **Resources**

### Key Takeaways
- Static strings may reveal infrastructure.
- Imports indicate interaction with OS components.
- Resources may reveal disguised icons or hidden data.

---

## Dynamic Analysis

### Using Regshot
1. Take **1st snapshot** before running sample.
2. Execute HopHelper.exe.
3. Take **2nd snapshot** after executing.
4. Compare snapshots.
5. Look for persistence mechanisms (e.g., Run keys).

### Using ProcMon
1. Start Process Monitor.
2. Run HopHelper.exe.
3. Stop capturing.
4. Apply filters:
   - Process name = HopHelper.exe
   - Useful operations:
     - RegOpenKey
     - CreateFile
     - TCP Connect / Receive
5. Use filtering to isolate meaningful behavior.

---

## No PoC Code Present in Source Text
- The passage contains no code blocks or PoC code to extract.

---

## Summary
These notes outline the approach to analyze HopHelper.exe:
- Gather initial metadata via static analysis.
- Execute in sandbox and observe system interactions.
- Use Regshot for registry diffs.
- Use ProcMon for filesystem, network, and registry behavior analysis.

